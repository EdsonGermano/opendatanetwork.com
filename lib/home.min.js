"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function delay(e){return new Promise(function(t,n){setTimeout(t,e)})}function multiComplete(e,t){function n(e){window.location.href=e}var o="odn.data.socrata.com",a=[{name:"Datasets",domain:o,fxf:"fpum-bjbr",column:"encoded",encoded:["domain","fxf"],select:function(e){return n("http://"+e.domain+"/dataset/"+e.fxf)},show:function(e){return"<span class='dataset-name'>"+e.text+"</span>                         <span class='dataset-domain'>"+e.domain+"</span>"}},{name:"Regions",domain:o,fxf:"7g2b-8brv",column:"autocomplete_name",select:function(e){return n("/"+e.text.replace(/ /g,"_"))}},{name:"Publishers",domain:o,fxf:"8ae5-ghum",column:"domain",select:function(e){return n("/search?domains="+e.text)}},{name:"Categories",domain:o,fxf:"864v-r7tf",column:"category",select:function(e){return n("/search?categories="+e.text)},show:function(e){return"<span class='capitalize'>"+e.text+"</span"}}],s=new Autosuggest(t,a);return s.listen(e),s}function regionsWithData(e,t){var n=_nameToColumn.has(e)?_nameToColumn.get(e):defaultColumn;return[_.extend({},_withDataSource,{select:t,column:n})]}$(document).ready(function(){$(".search-link").click(function(){var e=$("#q").val().trim();0===e.length?$("#q").focus():$("#form").submit()})}),Array.prototype.includes=function(e){return this.indexOf(e)>-1},String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(t,n){return"undefined"!=typeof e[n]?e[n]:t})},String.prototype.split2=function(e){var t=this.split(e);return 1==t.length&&""===t[0]?[]:t};var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),ApiController=function(){function e(){_classCallCheck(this,e),this.autoCompleteNameSuggestUrl="https://odn.data.socrata.com/views/7g2b-8brv/columns/autocomplete_name/suggest/{0}?size=10&fuzz=0",this.categoriesUrl="/categories.json",this.childRegionsUrl="https://odn.data.socrata.com/resource/eyae-8jfy?parent_id={0}&$limit={1}",this.costOfLivingUrl="https://odn.data.socrata.com/resource/hpnf-gnfu.json?$order=name&$where=",this.datasetSummaryUrl="https://{0}/api/views/{1}.json",this.domainsUrl="https://api.us.socrata.com/api/catalog/v1/domains",this.earningsByPlaceUrl="https://odn.data.socrata.com/resource/wmwh-4vak.json/?type=place&$limit=50000&$where=population%20%3E%205000",this.earningsUrl="https://odn.data.socrata.com/resource/wmwh-4vak.json?$where=",this.educationByPlaceUrl="https://odn.data.socrata.com/resource/uf4m-5u8r.json?type=place&$limit=50000&$where=population%20%3E%205000",this.educationUrl="https://odn.data.socrata.com/resource/uf4m-5u8r.json?$where=",this.gdpUrl="https://odn.data.socrata.com/resource/ks2j-vhr8.json?$where=",this.mostPopulousRegionTypeUrl="https://odn.data.socrata.com/resource/eyae-8jfy?parent_id={0}&child_type={1}&$limit={2}&$order=child_population desc",this.occupationsByPlaceUrl="https://odn.data.socrata.com/resource/qfcm-fw3i.json?occupation={0}&type=place&$limit=50000&$where=population%20%3E%205000",this.occupationsUrl="https://odn.data.socrata.com/resource/qfcm-fw3i.json?$order=occupation&$where=",this.parentStateUrl="https://odn.data.socrata.com/resource/eyae-8jfy?parent_type=state&child_id={0}",this.placeFromRosterUrl="https://odn.data.socrata.com/resource/kmnh-b5wu?id={0}",this.placesUrl="https://odn.data.socrata.com/resource/gm3u-gw57.json/?type=place&$limit=50000&$where=population%20%3E%205000",this.populationUrl="https://odn.data.socrata.com/resource/e3rd-zzmr.json?$order=year,name&$where=",this.similarRegionsUrl="https://socrata-peers.herokuapp.com/peers.json?id={0}&vectors={1}&n=10",this.supportedVectorsUrls="http://socrata-peers.herokuapp.com/supported.json?id={0}",this.healthDataUrls={rwjf_county_health_rankings_2015:"https://odn.data.socrata.com/resource/7ayp-utp2.json?$where=",cdc_brfss_prevalence_2011_2013:"https://odn.data.socrata.com/resource/n4rt-3rmd.json?$where="}}return _createClass(e,[{key:"getAutoCompleteNameSuggestions",value:function(e){return d3.promise.json(this.autoCompleteNameSuggestUrl.format(encodeURIComponent(e)))}},{key:"getCategories",value:function(){return d3.promise.json(this.categoriesUrl)}},{key:"getChildRegions",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?10:arguments[1];return d3.promise.json(this.childRegionsUrl.format(e,t))}},{key:"getCitiesInState",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?10:arguments[1];return d3.promise.json(this.mostPopulousRegionTypeUrl.format(e,"place",t))}},{key:"getCostOfLivingData",value:function(e){return this.getData(this.costOfLivingUrl,e)}},{key:"getCountiesInState",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?10:arguments[1];return d3.promise.json(this.mostPopulousRegionTypeUrl.format(e,"county",t))}},{key:"getData",value:function(e,t){var n=t.map(function(e){return"id='"+e+"'"});return d3.promise.json(e+encodeURI(n.join(" OR ")))}},{key:"getDatasetSummary",value:function(e,t){return d3.promise.json(this.datasetSummaryUrl.format(e,t))}},{key:"getDomains",value:function(){return d3.promise.json(this.domainsUrl)}},{key:"getEarningsByPlace",value:function(){return d3.promise.json(this.earningsByPlaceUrl)}},{key:"getEarningsData",value:function(e){return this.getData(this.earningsUrl,e)}},{key:"getEducationByPlace",value:function(){return d3.promise.json(this.educationByPlaceUrl)}},{key:"getEducationData",value:function(e){return this.getData(this.educationUrl,e)}},{key:"getGdpData",value:function(e){return this.getData(this.gdpUrl,e)}},{key:"getMetrosInState",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?10:arguments[1];return d3.promise.json(this.mostPopulousRegionTypeUrl.format(e,"msa",t))}},{key:"getOccupationsByPlace",value:function(e){return d3.promise.json(this.occupationsByPlaceUrl.format(e))}},{key:"getOccupationsData",value:function(e){return this.getData(this.occupationsUrl,e)}},{key:"getParentState",value:function(e){return d3.promise.json(this.parentStateUrl.format(e.id))}},{key:"getPlaceFromRoster",value:function(e){return d3.promise.json(this.placeFromRosterUrl.format(e))}},{key:"getPopulationData",value:function(e){return this.getData(this.populationUrl,e)}},{key:"getPlaces",value:function(){return d3.promise.json(this.placesUrl)}},{key:"getSimilarRegions",value:function(e,t){return d3.promise.json(this.similarRegionsUrl.format(e,t.join(",")))}},{key:"getSupportedVectors",value:function(e){return d3.promise.json(this.supportedVectorsUrls.format(e))}},{key:"getHealthRwjfChrData",value:function(e){return this.getData(this.healthDataUrls.rwjf_county_health_rankings_2015,e)}}]),e}(),Constants={ROSTER_URL:"https://federal.demo.socrata.com/resource/7g2b-8brv.json",AUTOCOMPLETE_SEPARATOR:":",AUTOCOMPLETE_URL:function(e,t,n,o){return"https://"+e+"/views/"+t+"/columns/"+n+"/suggest/"+o+"?size=5"},AUTOCOMPLETE_WAIT_MS:150},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),RegionLookup=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"get",value:function(e){return $.getJSON(Constants.ROSTER_URL+"?"+$.param(e))}},{key:"getOne",value:function(t){function n(e){if(0===e.length)return console.warn("no regions found for params: "),console.warn(t),null;if(1===e.length)return e[0];var n=_.filter(e,function(e){return"place"===e.type});return n.length>0?n[0]:e[0]}return new Promise(function(o,a){e.get(t).then(function(e){o(n(e))},function(e){throw e})})}},{key:"byName",value:function(t){return e.getOne({name:t})}},{key:"byID",value:function(t){return e.getOne({id:t})}},{key:"byAutocompleteName",value:function(t){return e.getOne({autocomplete_name:t})}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),Base64=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"encode",value:function(e){return btoa(unescape(encodeURIComponent(str)))}},{key:"decode",value:function(e){return decodeURIComponent(escape(atob(e)))}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),AutosuggestSource=function(){function e(t,n,o,a,s,r,i){_classCallCheck(this,e),this.name=t,this.domain=n,this.fxf=o,this.column=a,this.encoded=s,this.select=r,this.show=i}return _createClass(e,[{key:"get",value:function(e){var t=this;return new Promise(function(n,o){if(""===e)n([]);else{var a=Constants.AUTOCOMPLETE_URL(t.domain,t.fxf,t.column,e);$.getJSON(a).then(function(e){n(e.options.map(function(e){return t.decode(e)}))},o)}})}},{key:"decode",value:function(e){if(this.encoded.length>0){var t=e.text,n=t.lastIndexOf(" "),o=t.substring(0,n),a=t.substring(n+1),s=Base64.decode(a),r=s.split(Constants.AUTOCOMPLETE_SEPARATOR);return _.extend({text:o},_.object(this.encoded,r))}return{text:e.text}}},{key:"display",value:function(e,t){var n=this;if(0===t.length)return[];var o=e.append("div").attr("class","autocomplete-category"),a=(o.append("p").attr("class","autocomplete-title").text(this.name),o.append("div").attr("class","autocomplete-options"));return a.selectAll("li").data(t).enter().append("li").html(function(e){return n.show(e)}).on("click",function(e){return n.select(e)}).on("mouseover.source",function(){d3.select(this).classed("selected hovered",!0)}).on("mouseout.source",function(){d3.select(this).classed("selected hovered",!1)})[0]}}],[{key:"fromJSON",value:function(t){var n=t.encoded||[],o=t.show||function(e){return e.text};return new e(t.name,t.domain,t.fxf,t.column,n,t.select,o)}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),AutosuggestResults=function(){function e(t){_classCallCheck(this,e),this.results=d3.select(t),this.options=[],this.index=-1,this.autohide()}return _createClass(e,[{key:"autohide",value:function(){var e=this;d3.select("html").on("click.results",function(){return e.hide()}),this.results.on("click.results",function(){return d3.event.stopPropagation()})}},{key:"hide",value:function(){this.results.style("display","none")}},{key:"unhide",value:function(){this.results.style("display","block")}},{key:"empty",value:function(){this.results.html("")}},{key:"display",value:function(e){var t=this;return new Promise(function(n,o){t.source.get(e).then(function(e){t.empty(),0===e.length?(t.hide(),n([])):(t.unhide(),n(t.source.display(t.results,e)))},function(e){throw e})})}},{key:"show",value:function(e,t){var n=this;this.empty();var o=e.map(function(e,o){var a=t[o];return e.display(n.results,a)});this.updateOptions(_.flatten(o)),this.unhide()}},{key:"updateOptions",value:function(e){var t=this;this.options=e.map(function(e){return d3.select(e)}),this.options.forEach(function(e,n){e.on("mouseover.results",function(){t.index=n,t.updateSelected()}).on("mouseout.results",function(){t.index=-1,t.updateSelected()})})}},{key:"updateSelected",value:function(){var e=this;this.options.forEach(function(t,n){t.classed("selected",n===e.index)})}},{key:"keydown",value:function(e){38==e?this.up():40==e&&this.down(),this.updateSelected()}},{key:"up",value:function(){this.index>=0&&(this.index-=1)}},{key:"down",value:function(){this.index<this.options.length-1&&(this.index+=1)}},{key:"enter",value:function(){var e=this.options[this.index];e.on("click")(e.datum())}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),Autosuggest=function(){function e(t,n){_classCallCheck(this,e),this.sources=n.map(AutosuggestSource.fromJSON),this.results=new AutosuggestResults(t),this._currentTerm="",this._time=Date.now()}return _createClass(e,[{key:"listen",value:function(e){var t=this;d3.select(e).on("keydown",function(){t.keydown(d3.event.keyCode),d3.event.stopPropagation()}).on("input",function(){t.throttledSuggest(this.value)})}},{key:"throttledSuggest",value:function(e){var t=this;delay(Constants.AUTOCOMPLETE_WAIT_MS).then(function(){e===t._currentTerm&&t.suggest(e)}),this._currentTerm=e}},{key:"suggest",value:function(e){var t=this;""===e?this.results.hide():!function(){var n=Date.now(),o=t.sources.map(function(t){return t.get(e)});Promise.all(o).then(function(e){n>t._time&&(t._time=n,t.results.show(t.sources,e))})}()}},{key:"keydown",value:function(e){13==e?this.enter():this.results.keydown(e)}},{key:"enter",value:function(){if(this.results.index<0){var e="/search?"+$.param({q:this._currentTerm});window.location.href=e}else this.results.enter()}}]),e}(),domain="odn.data.socrata.com",_nameToColumn=new Map;_nameToColumn.set("population","population"),_nameToColumn.set("earnings","earnings"),_nameToColumn.set("education","education"),_nameToColumn.set("occupations","occupations"),_nameToColumn.set("cost_of_living","rpp"),_nameToColumn.set("gdp","gdp");var defaultColumn="population",_withDataSource={name:"Regions with Data",domain:domain,fxf:"pfgp-ifph"};$(document).ready(function(){$(".slider").slick({arrows:!1,autoplay:!0,autoplaySpeed:2e3,slidesToScroll:1,slidesToShow:5}),multiComplete("#q",".region-list").listen(),$("#search-button").click(function(){$("#form").submit()}),$("#menu-item-communities").mouseenter(function(){$("#menu-communities").slideToggle(100),$("#menu-item-communities").addClass("selected"),searchMenu.hideOptionsMenu()}),$("#menu-item-communities").mouseleave(function(){$("#menu-communities").hide(100),$("#menu-item-communities").removeClass("selected")})});
//# sourceMappingURL=home.min.js.map
