function AutoSuggestRegionController(inputTextSelector,resultListSelector,onClickRegion){this.options=[],this.selectedIndex=-1,this.resultListSelector=resultListSelector,this.timer=null;var autoSuggestDelay=150,self=this;$(resultListSelector+" li").click(function(){onClickRegion&&onClickRegion(self.options[$(this).index()].text)}),$(resultListSelector+" li").mouseenter(function(){self.selectedIndex=$(this).index(),self.updateListSelection()}),$(inputTextSelector).keyup(function(e){if(38==e.keyCode)return e.preventDefault(),self.selectedIndex=self.selectedIndex>-1?self.selectedIndex-1:-1,void self.updateListSelection();if(40==e.keyCode)return e.preventDefault(),self.selectedIndex=self.selectedIndex<self.options.length-1?self.selectedIndex+1:self.options.length-1,void self.updateListSelection();if(13==e.keyCode){if(-1==self.selectedIndex||self.selectedIndex>=self.options.length)return;return e.preventDefault(),void(onClickRegion&&onClickRegion(self.options[self.selectedIndex].text))}if(27==e.keyCode)return void $(resultListSelector).slideUp(100);clearTimeout(this.timer);var searchTerm=$(inputTextSelector).val().trim();return 0==searchTerm.length?void $(resultListSelector).slideUp(100):void(this.timer=setTimeout(function(){self.autoSuggest(searchTerm,resultListSelector)},autoSuggestDelay))})}AutoSuggestRegionController.prototype.autoSuggest=function(searchTerm,resultListSelector){var self=this,apiController=new ApiController;apiController.getAutoCompleteNameSuggestions(searchTerm,function(data){self.options=data.options,self.selectedIndex=-1;var regionList=$(resultListSelector);if(0==self.options.length)return void regionList.slideUp(100);var items=self.options.map(function(item){return"<li>"+item.text+"</li>"});regionList.html(items.join("")),regionList.slideDown(100)})},AutoSuggestRegionController.prototype.updateListSelection=function(){var self=this;$(this.resultListSelector+" li").each(function(index){index==self.selectedIndex?$(this).addClass("selected"):$(this).removeClass("selected")})};