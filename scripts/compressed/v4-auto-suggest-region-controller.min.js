"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),AutoSuggestRegionController=function(){function AutoSuggestRegionController(inputTextSelector,resultListSelector,onClickRegion){var _this=this;_classCallCheck(this,AutoSuggestRegionController),this.options=[],this.selectedIndex=-1,this.resultListSelector=resultListSelector,this.timer=null,this.onClickRegion=onClickRegion;var autoSuggestDelay=150;$(inputTextSelector).keyup(function(e){if(38==e.keyCode)return e.preventDefault(),_this.selectedIndex=_this.selectedIndex>-1?_this.selectedIndex-1:-1,void _this.updateListSelection();if(40==e.keyCode)return e.preventDefault(),_this.selectedIndex=_this.selectedIndex<_this.options.length-1?_this.selectedIndex+1:_this.options.length-1,void _this.updateListSelection();if(13==e.keyCode){if(-1==_this.selectedIndex||_this.selectedIndex>=_this.options.length)return;return e.preventDefault(),void(_this.onClickRegion&&_this.onClickRegion(_this.options[_this.selectedIndex].text))}if(27==e.keyCode)return void $(resultListSelector).slideUp(100);clearTimeout(_this.timer);var searchTerm=$(inputTextSelector).val().trim();return 0==searchTerm.length?void $(resultListSelector).slideUp(100):void(_this.timer=setTimeout(function(){_this.autoSuggest(searchTerm,resultListSelector)},autoSuggestDelay))})}return _createClass(AutoSuggestRegionController,[{key:"autoSuggest",value:function(searchTerm,resultListSelector){var self=this,apiController=new ApiController;apiController.getAutoCompleteNameSuggestions(searchTerm,function(data){self.options=data.options,self.selectedIndex=-1;var regionList=$(resultListSelector);if(0==self.options.length)return void regionList.slideUp(100);var items=self.options.map(function(item){return"<li>"+item.text+"</li>"});regionList.html(items.join("")),$(resultListSelector+" li").click(function(){self.onClickRegion&&self.onClickRegion(self.options[$(this).index()].text)}),$(resultListSelector+" li").mouseenter(function(){self.selectedIndex=$(this).index(),self.updateListSelection()}),regionList.slideDown(100)})}},{key:"updateListSelection",value:function(){var self=this;$(this.resultListSelector+" li").each(function(index){index==self.selectedIndex?$(this).addClass("selected"):$(this).removeClass("selected")})}}]),AutoSuggestRegionController}();