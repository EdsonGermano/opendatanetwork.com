function AutoSuggestRegionController(inputTextSelector,resultListSelector,onClickRegion){this.options=[],this.selectedIndex=-1,this.resultListSelector=resultListSelector,this.onClickRegion=onClickRegion;var self=this;$(inputTextSelector).keydown(function(e){if(38==e.keyCode)return e.preventDefault(),self.selectedIndex=self.selectedIndex>-1?self.selectedIndex-1:-1,void self.updateListSelection();if(40==e.keyCode)return e.preventDefault(),self.selectedIndex=self.selectedIndex<self.options.length-1?self.selectedIndex+1:self.options.length-1,void self.updateListSelection();if(13==e.keyCode){if(-1==self.selectedIndex||self.selectedIndex>=self.options.length)return;return e.preventDefault(),void self.selectRegion(self.selectedIndex)}if(27==e.keyCode)return void $(resultListSelector).slideUp(100);var searchTerm=$(inputTextSelector).val().trim();if(0==searchTerm.length)return void $(resultListSelector).slideUp(100);var apiController=new ApiController;apiController.getAutoCompleteNameSuggestions(searchTerm,function(data){self.options=data.options,self.selectedIndex=-1;var regionList=$(resultListSelector);if(0==self.options.length)return void regionList.slideUp(100);var items=self.options.map(function(item){return"<li>"+item.text+"</li>"});regionList.html(items.join("")),$(resultListSelector+" li").click(function(){self.selectRegion($(this).index())}),$(resultListSelector+" li").mouseenter(function(){self.selectedIndex=$(this).index(),self.updateListSelection()}),regionList.slideDown(100)})})}AutoSuggestRegionController.prototype.selectRegion=function(index){this.onClickRegion&&this.onClickRegion(this.options[index].text)},AutoSuggestRegionController.prototype.updateListSelection=function(){var self=this;$(this.resultListSelector+" li").each(function(index){index==self.selectedIndex?$(this).addClass("selected"):$(this).removeClass("selected")})};