"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),ApiController=function(){function ApiController(){_classCallCheck(this,ApiController),this.autoCompleteNameSuggestUrl="https://federal.demo.socrata.com/views/7g2b-8brv/columns/autocomplete_name/suggest/{0}?size=10&fuzz=0",this.categoriesUrl="/categories.json",this.childRegionsUrl="https://federal.demo.socrata.com/resource/eyae-8jfy?parent_id={0}&$limit={1}",this.costOfLivingUrl="https://federal.demo.socrata.com/resource/hpnf-gnfu.json?$order=name&$where=",this.domainsUrl="https://api.us.socrata.com/api/catalog/v1/domains",this.earningsUrl="https://federal.demo.socrata.com/resource/wmwh-4vak.json?$where=",this.educationUrl="https://federal.demo.socrata.com/resource/uf4m-5u8r.json?$where=",this.gdpUrl="https://federal.demo.socrata.com/resource/ks2j-vhr8.json?$where=",this.mostPopulousRegionTypeUrl="https://federal.demo.socrata.com/resource/eyae-8jfy?parent_id={0}&child_type={1}&$limit={2}&$order=child_population desc",this.occupationsUrl="https://federal.demo.socrata.com/resource/qfcm-fw3i.json?$order=occupation&$where=",this.parentStateUrl="https://federal.demo.socrata.com/resource/eyae-8jfy?parent_type=state&child_id={0}",this.populationUrl="https://federal.demo.socrata.com/resource/e3rd-zzmr.json?$order=year,name&$where=",this.similarRegionsUrl="https://socrata-peers.herokuapp.com/peers.json?vectors=population_change,earnings,occupation,education,population&n=10&id={0}"}return _createClass(ApiController,[{key:"getCategories",value:function(){return d3.promise.json(this.categoriesUrl)}},{key:"getChildRegions",value:function(regionId){var limit=arguments.length<=1||void 0===arguments[1]?10:arguments[1];return d3.promise.json(this.childRegionsUrl.format(regionId,limit))}},{key:"getCountiesInState",value:function(stateId){var limit=arguments.length<=1||void 0===arguments[1]?10:arguments[1];return d3.promise.json(this.mostPopulousRegionTypeUrl.format(stateId,"county",limit))}},{key:"getDomains",value:function(){return d3.promise.json(this.domainsUrl)}},{key:"getMetrosInState",value:function(stateId){var limit=arguments.length<=1||void 0===arguments[1]?10:arguments[1];return d3.promise.json(this.mostPopulousRegionTypeUrl.format(stateId,"msa",limit))}},{key:"getCitiesInState",value:function(stateId){var limit=arguments.length<=1||void 0===arguments[1]?10:arguments[1];return d3.promise.json(this.mostPopulousRegionTypeUrl.format(stateId,"place",limit))}},{key:"getParentState",value:function(region){return d3.promise.json(this.parentStateUrl.format(region.id))}},{key:"getSimilarRegions",value:function(regionId){return d3.promise.json(this.similarRegionsUrl.format(regionId))}},{key:"getAutoCompleteNameSuggestions",value:function(searchTerm,completionHandler){$.getJSON(this.autoCompleteNameSuggestUrl.format(encodeURIComponent(searchTerm)),completionHandler)}},{key:"getCostOfLivingData",value:function(regionIds,completionHandler){this.getData(this.costOfLivingUrl,regionIds,completionHandler)}},{key:"getEarningsData",value:function(regionIds,completionHandler){this.getData(this.earningsUrl,regionIds,completionHandler)}},{key:"getEducationData",value:function(regionIds,completionHandler){this.getData(this.educationUrl,regionIds,completionHandler)}},{key:"getGdpData",value:function(regionIds,completionHandler){this.getData(this.gdpUrl,regionIds,completionHandler)}},{key:"getOccupationsData",value:function(regionIds,completionHandler){this.getData(this.occupationsUrl,regionIds,completionHandler)}},{key:"getPopulationData",value:function(regionIds,completionHandler){this.getData(this.populationUrl,regionIds,completionHandler)}},{key:"getData",value:function(url,regionIds,completionHandler){var segments=regionIds.map(function(regionId){return"id='"+regionId+"'"});$.getJSON(url+encodeURI(segments.join(" OR ")),completionHandler)}}]),ApiController}();