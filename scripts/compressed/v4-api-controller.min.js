"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),ApiController=function(){function ApiController(){_classCallCheck(this,ApiController),this.autoCompleteNameSuggestUrl="https://odn.data.socrata.com/views/7g2b-8brv/columns/autocomplete_name/suggest/{0}?size=10&fuzz=0",this.categoriesUrl="/categories.json",this.childRegionsUrl="https://federal.demo.socrata.com/resource/eyae-8jfy?parent_id={0}&$limit={1}",this.costOfLivingUrl="https://federal.demo.socrata.com/resource/hpnf-gnfu.json?$order=name&$where=",this.domainsUrl="https://api.us.socrata.com/api/catalog/v1/domains",this.earningsByPlaceUrl="https://federal.demo.socrata.com/resource/wmwh-4vak.json/?type=place&$limit=50000&$where=population%20%3E%205000",this.earningsUrl="https://federal.demo.socrata.com/resource/wmwh-4vak.json?$where=",this.educationByPlaceUrl="https://federal.demo.socrata.com/resource/uf4m-5u8r.json?type=place&$limit=50000&$where=population%20%3E%205000",this.educationUrl="https://federal.demo.socrata.com/resource/uf4m-5u8r.json?$where=",this.gdpUrl="https://federal.demo.socrata.com/resource/ks2j-vhr8.json?$where=",this.mostPopulousRegionTypeUrl="https://federal.demo.socrata.com/resource/eyae-8jfy?parent_id={0}&child_type={1}&$limit={2}&$order=child_population desc",this.occupationsUrl="https://federal.demo.socrata.com/resource/qfcm-fw3i.json?$order=occupation&$where=",this.parentStateUrl="https://federal.demo.socrata.com/resource/eyae-8jfy?parent_type=state&child_id={0}",this.placesUrl="https://federal.demo.socrata.com/resource/gm3u-gw57.json/?type=place&$limit=50000&$where=population%20%3E%205000",this.populationUrl="https://federal.demo.socrata.com/resource/e3rd-zzmr.json?$order=year,name&$where=",this.similarRegionsUrl="https://socrata-peers.herokuapp.com/peers.json?vectors=population_change,earnings,occupation,education,population&n=10&id={0}",this.healthDataUrls={rwjf_county_health_rankings_2015:"https://odn.data.socrata.com/resource/7ayp-utp2.json?$where=",cdc_brfss_prevalence_2011_2013:"https://odn.data.socrata.com/resource/n4rt-3rmd.json?$where="}}return _createClass(ApiController,[{key:"getAutoCompleteNameSuggestions",value:function(searchTerm){return d3.promise.json(this.autoCompleteNameSuggestUrl.format(encodeURIComponent(searchTerm)))}},{key:"getCategories",value:function(){return d3.promise.json(this.categoriesUrl)}},{key:"getChildRegions",value:function(regionId){var limit=arguments.length<=1||void 0===arguments[1]?10:arguments[1];return d3.promise.json(this.childRegionsUrl.format(regionId,limit))}},{key:"getCitiesInState",value:function(stateId){var limit=arguments.length<=1||void 0===arguments[1]?10:arguments[1];return d3.promise.json(this.mostPopulousRegionTypeUrl.format(stateId,"place",limit))}},{key:"getCostOfLivingData",value:function(regionIds){return this.getData(this.costOfLivingUrl,regionIds)}},{key:"getCountiesInState",value:function(stateId){var limit=arguments.length<=1||void 0===arguments[1]?10:arguments[1];return d3.promise.json(this.mostPopulousRegionTypeUrl.format(stateId,"county",limit))}},{key:"getData",value:function(url,regionIds){var segments=regionIds.map(function(regionId){return"id='"+regionId+"'"});return d3.promise.json(url+encodeURI(segments.join(" OR ")))}},{key:"getDomains",value:function(){return d3.promise.json(this.domainsUrl)}},{key:"getEarningsByPlace",value:function(){return d3.promise.json(this.earningsByPlaceUrl)}},{key:"getEarningsData",value:function(regionIds){return this.getData(this.earningsUrl,regionIds)}},{key:"getEducationByPlace",value:function(){return d3.promise.json(this.educationByPlaceUrl)}},{key:"getEducationData",value:function(regionIds){return this.getData(this.educationUrl,regionIds)}},{key:"getGdpData",value:function(regionIds){return this.getData(this.gdpUrl,regionIds)}},{key:"getMetrosInState",value:function(stateId){var limit=arguments.length<=1||void 0===arguments[1]?10:arguments[1];return d3.promise.json(this.mostPopulousRegionTypeUrl.format(stateId,"msa",limit))}},{key:"getOccupationsData",value:function(regionIds){return this.getData(this.occupationsUrl,regionIds)}},{key:"getParentState",value:function(region){return d3.promise.json(this.parentStateUrl.format(region.id))}},{key:"getPopulationData",value:function(regionIds){return this.getData(this.populationUrl,regionIds)}},{key:"getPlaces",value:function(){return d3.promise.json(this.placesUrl)}},{key:"getSimilarRegions",value:function(regionId){return d3.promise.json(this.similarRegionsUrl.format(regionId))}},{key:"getHealthRwjfChrData",value:function(regionIds){return this.getData(this.healthDataUrls.rwjf_county_health_rankings_2015,regionIds)}}]),ApiController}();