{"version":3,"sources":["../v4-auto-suggest-region-controller.js"],"names":[],"mappings":"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","file":"v4-auto-suggest-region-controller.js","sourcesContent":["class AutoSuggestRegionController {\n\n    constructor(inputTextSelector, resultListSelector, onClickRegion) {\n\n        this.options = [];\n        this.selectedIndex = -1;\n        this.resultListSelector = resultListSelector;\n        this.timer = null;\n        this.onClickRegion = onClickRegion;\n\n        var autoSuggestDelay = 150;\n\n        // Keyboard event\n        //\n        $(inputTextSelector).keyup((e) => {\n\n            if (e.keyCode == 38) { // up\n\n                e.preventDefault();\n\n                this.selectedIndex = (this.selectedIndex > -1) ? this.selectedIndex - 1 : -1;\n                this.updateListSelection();\n                return;\n            }\n            else if (e.keyCode == 40) { // down\n\n                e.preventDefault();\n\n                this.selectedIndex = (this.selectedIndex < this.options.length - 1) ? this.selectedIndex + 1 : this.options.length - 1;\n                this.updateListSelection();\n                return;\n            }\n            else if (e.keyCode == 13) { // enter\n    \n                if ((this.selectedIndex == -1) || (this.selectedIndex >= this.options.length))\n                    return;\n\n                e.preventDefault();\n\n                if (this.onClickRegion) \n                    this.onClickRegion(this.options[this.selectedIndex].text);\n\n                return;\n            }\n            else if (e.keyCode == 27) { // esc \n\n                $(resultListSelector).slideUp(100);\n                return;\n            }\n\n            // Clear the timer\n            //\n            clearTimeout(this.timer);\n    \n            // Get the search value\n            //\n            var searchTerm = $(inputTextSelector).val().trim();\n\n            if (searchTerm.length == 0) {\n\n                $(resultListSelector).slideUp(100);\n                return;\n            }\n\n            // Set new timer to auto suggest\n            //\n            this.timer = setTimeout(\n                () => { this.autoSuggest(searchTerm, resultListSelector); },\n                autoSuggestDelay);\n        });\n    }\n\n    autoSuggest(searchTerm, resultListSelector) {\n\n        var controller = new ApiController();\n\n        controller.getAutoCompleteNameSuggestions(searchTerm)\n            .then(data => {\n    \n                this.options = data.options;\n                this.selectedIndex = -1;\n    \n                var regionList = $(resultListSelector);\n    \n                if (this.options.length == 0) {\n    \n                    regionList.slideUp(100);\n                    return;\n                }\n    \n                // Build the list items\n                //\n                var items = this.options.map(function(item) { return '<li>' + item.text + '</li>'; });\n                regionList.html(items.join(''));\n    \n                // Click event\n                //\n                var self = this;\n\n                $(resultListSelector + ' li').click(function() {\n    \n                    if (self.onClickRegion) \n                        self.onClickRegion(self.options[$(this).index()].text);\n                });\n    \n                // Mouse event\n                //   \n                $(resultListSelector + ' li').mouseenter(function() {\n    \n                    self.selectedIndex = $(this).index();\n                    self.updateListSelection();\n                });\n    \n                // Slide the list down\n                //\n                regionList.slideDown(100);\n            })\n            .catch(error => console.error(error));\n    }\n\n    updateListSelection() {\n\n        var self = this;\n\n        $(this.resultListSelector + ' li').each(function(index) {\n\n            if (index == self.selectedIndex)\n                $(this).addClass('selected');\n            else\n                $(this).removeClass('selected');\n        });\n    }\n}"]}