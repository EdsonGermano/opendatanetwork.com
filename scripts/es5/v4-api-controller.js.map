{"version":3,"sources":["../v4-api-controller.js"],"names":[],"mappings":"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","file":"v4-api-controller.js","sourcesContent":["class ApiController {\n\n    constructor() {\n\n        this.autoCompleteNameSuggestUrl = 'https://odn.data.socrata.com/views/7g2b-8brv/columns/autocomplete_name/suggest/{0}?size=10&fuzz=0';\n        this.categoriesUrl = '/categories.json';\n        this.childRegionsUrl = 'https://odn.data.socrata.com/resource/eyae-8jfy?parent_id={0}&$limit={1}';\n        this.costOfLivingUrl = 'https://odn.data.socrata.com/resource/hpnf-gnfu.json?$order=name&$where=';\n        this.domainsUrl = 'https://api.us.socrata.com/api/catalog/v1/domains';\n        this.earningsByPlaceUrl = 'https://odn.data.socrata.com/resource/wmwh-4vak.json/?type=place&$limit=50000&$where=population%20%3E%205000';\n        this.earningsUrl = 'https://odn.data.socrata.com/resource/wmwh-4vak.json?$where=';\n        this.educationByPlaceUrl = 'https://odn.data.socrata.com/resource/uf4m-5u8r.json?type=place&$limit=50000&$where=population%20%3E%205000';\n        this.educationUrl = 'https://odn.data.socrata.com/resource/uf4m-5u8r.json?$where=';\n        this.gdpUrl = 'https://odn.data.socrata.com/resource/ks2j-vhr8.json?$where=';\n        this.mostPopulousRegionTypeUrl = 'https://odn.data.socrata.com/resource/eyae-8jfy?parent_id={0}&child_type={1}&$limit={2}&$order=child_population desc';\n        this.occupationsByPlaceUrl = 'https://odn.data.socrata.com/resource/qfcm-fw3i.json?occupation={0}&type=place&$limit=50000&$where=population%20%3E%205000';\n        this.occupationsUrl = 'https://odn.data.socrata.com/resource/qfcm-fw3i.json?$order=occupation&$where=';\n        this.parentStateUrl = 'https://odn.data.socrata.com/resource/eyae-8jfy?parent_type=state&child_id={0}';\n        this.placesUrl = 'https://odn.data.socrata.com/resource/gm3u-gw57.json/?type=place&$limit=50000&$where=population%20%3E%205000';\n        this.populationUrl = 'https://odn.data.socrata.com/resource/e3rd-zzmr.json?$order=year,name&$where=';\n        this.similarRegionsUrl = 'https://socrata-peers.herokuapp.com/peers.json?vectors=population_change,earnings,occupation,education,population&n=10&id={0}';\n        this.healthDataUrls = {\n            rwjf_county_health_rankings_2015: \"https://odn.data.socrata.com/resource/7ayp-utp2.json?$where=\",\n            cdc_brfss_prevalence_2011_2013: \"https://odn.data.socrata.com/resource/n4rt-3rmd.json?$where=\"\n        }\n    }\n\n    // Promises\n    //\n    getAutoCompleteNameSuggestions(searchTerm) {\n\n        return d3.promise.json(this.autoCompleteNameSuggestUrl.format(encodeURIComponent(searchTerm)));\n    }\n\n    getCategories() {\n\n        return d3.promise.json(this.categoriesUrl);\n    }\n\n    getChildRegions(regionId, limit = 10) {\n\n        return d3.promise.json(this.childRegionsUrl.format(regionId, limit));\n    }\n\n    getCitiesInState(stateId, limit = 10) {\n\n        return d3.promise.json(this.mostPopulousRegionTypeUrl.format(stateId, 'place', limit));\n    }\n\n    getCostOfLivingData(regionIds) {\n\n        return this.getData(this.costOfLivingUrl, regionIds);\n    }\n\n    getCountiesInState(stateId, limit = 10) {\n\n        return d3.promise.json(this.mostPopulousRegionTypeUrl.format(stateId, 'county', limit));\n    }\n    \n    getData(url, regionIds) {\n\n        var segments = regionIds.map(function(regionId) {\n            return 'id=\\'' + regionId + '\\''; \n        });\n\n        return d3.promise.json(url + encodeURI(segments.join(' OR ')));\n    }\n    \n    getDomains() {\n\n        return d3.promise.json(this.domainsUrl);\n    }\n\n    getEarningsByPlace() {\n\n        return d3.promise.json(this.earningsByPlaceUrl);\n    }\n\n    getEarningsData(regionIds) {\n\n        return this.getData(this.earningsUrl, regionIds);\n    }\n\n    getEducationByPlace() {\n\n        return d3.promise.json(this.educationByPlaceUrl);\n    }\n\n    getEducationData(regionIds) {\n\n        return this.getData(this.educationUrl, regionIds);\n    }\n\n    getGdpData(regionIds) {\n\n        return this.getData(this.gdpUrl, regionIds);\n    }\n\n    getMetrosInState(stateId, limit = 10) {\n\n        return d3.promise.json(this.mostPopulousRegionTypeUrl.format(stateId, 'msa', limit));\n    }\n\n    getOccupationsByPlace(occupation) {\n\n        return d3.promise.json(this.occupationsByPlaceUrl.format(occupation));\n    }\n\n    getOccupationsData(regionIds) {\n\n        return this.getData(this.occupationsUrl, regionIds);\n    }\n\n    getParentState(region) {\n\n        return d3.promise.json(this.parentStateUrl.format(region.id));\n    }\n\n    getPopulationData(regionIds) {\n\n        return this.getData(this.populationUrl, regionIds);\n    }\n\n    getPlaces() {\n\n        return d3.promise.json(this.placesUrl);\n    }\n\n    getSimilarRegions(regionId) {\n\n        return d3.promise.json(this.similarRegionsUrl.format(regionId));\n    }\n\n    // health data retrievers\n    getHealthRwjfChrData(regionIds) {\n        return this.getData(this.healthDataUrls.rwjf_county_health_rankings_2015, regionIds);\n    }\n}"]}